<Window x:Class="QAAutomationUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="QA Automation Platform" Height="850" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#F1F5F9">

    <Window.Resources>
        <!-- Modern Button Styles -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="#2563EB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1D4ED8"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#10B981"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#059669"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#EF4444"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#DC2626"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="#6B7280"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#4B5563"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Card Style -->
        <Style x:Key="Card" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="10" ShadowDepth="0"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern TextBox Style -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Padding" Value="10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderBrush" Value="#D1D5DB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="White"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="250"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" CornerRadius="0" Height="80">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#2563EB" Offset="0"/>
                    <GradientStop Color="#7C3AED" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid Margin="30,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Left side: Suite info -->
                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock Text="🤖 QA Automation Platform"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="White"/>
                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                        <TextBlock x:Name="lblSuiteName"
                                   Text="Suite: Default"
                                   FontSize="12"
                                   Foreground="#E0E7FF"/>
                        <TextBlock Text=" • " FontSize="12" Foreground="#E0E7FF" Margin="5,0"/>
                        <TextBlock x:Name="lblSuiteUrl"
                                   Text="URL: Not set"
                                   FontSize="12"
                                   Foreground="#E0E7FF"
                                   MaxWidth="500"
                                   TextTrimming="CharacterEllipsis"/>
                        <Button x:Name="btnEditConfig"
                                Content="⚙️"
                                Width="24"
                                Height="24"
                                Margin="8,0,0,0"
                                Background="Transparent"
                                BorderThickness="0"
                                Foreground="White"
                                FontSize="14"
                                Cursor="Hand"
                                ToolTip="Edit suite configuration"
                                Click="BtnEditConfig_Click"/>
                    </StackPanel>
                </StackPanel>

                <!-- Right side: Status -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center">
                    <Button x:Name="btnStopExecution"
                            Content="⏹️ Stop"
                            Style="{StaticResource DangerButton}"
                            Padding="15,8"
                            FontSize="12"
                            Margin="0,0,10,0"
                            Visibility="Collapsed"
                            Click="BtnStopExecution_Click"/>
                    <TextBlock x:Name="lblStatus"
                               Text="● Ready"
                               FontSize="14"
                               Foreground="#10B981"
                               FontWeight="SemiBold"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <TabControl x:Name="mainTabControl" Grid.Row="1" Margin="20,20,20,0" BorderThickness="0" Background="Transparent">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="TabBorder"
                                        Background="White"
                                        BorderThickness="0"
                                        CornerRadius="8,8,0,0"
                                        Padding="20,12"
                                        Margin="0,0,5,0">
                                    <ContentPresenter ContentSource="Header"
                                                      HorizontalAlignment="Center"
                                                      VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="TabBorder" Property="Background" Value="#E5E7EB"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="TabBorder" Property="Background">
                                            <Setter.Value>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                    <GradientStop Color="#2563EB" Offset="0"/>
                                                    <GradientStop Color="#7C3AED" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Setter.Value>
                                        </Setter>
                                        <Setter TargetName="TabBorder" Property="Effect">
                                            <Setter.Value>
                                                <DropShadowEffect Color="#000000" Opacity="0.2" BlurRadius="15" ShadowDepth="0"/>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Foreground" Value="#374151"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </TabControl.Resources>

            <!-- Recorder Tab -->
            <TabItem Header="📹 Test Recorder">
                <Border Style="{StaticResource Card}" Margin="0,0,0,0">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Test Name -->
                            <TextBlock Text="Test Name" FontSize="14" FontWeight="SemiBold" Foreground="#374151" Margin="0,0,0,8"/>
                            <TextBox x:Name="txtTestName"
                                     Style="{StaticResource ModernTextBox}"
                                     Margin="0,0,0,20"/>

                            <!-- Recording Controls -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Button x:Name="btnOpenBrowser"
                                        Content="🌐 Open Browser"
                                        Style="{StaticResource PrimaryButton}"
                                        Click="BtnOpenBrowser_Click"
                                        Margin="0,0,10,0"/>
                                <Button Content="🎬 Start Recording"
                                        Style="{StaticResource SuccessButton}"
                                        Click="BtnStartRecording_Click"
                                        Margin="0,0,10,0"/>
                                <Button x:Name="btnStopRecording"
                                        Content="🛑 Stop Recording"
                                        Style="{StaticResource DangerButton}"
                                        Click="BtnStopRecording_Click"
                                        Visibility="Collapsed"/>
                            </StackPanel>

                            <!-- Information Panel -->
                            <Border Background="#EFF6FF"
                                    BorderBrush="#BFDBFE"
                                    BorderThickness="1"
                                    CornerRadius="6"
                                    Padding="15">
                                <StackPanel>
                                    <TextBlock Text="📖 How Recording Works (Like Ranorex!)" FontWeight="SemiBold" Foreground="#1E40AF" Margin="0,0,0,8"/>
                                    <TextBlock TextWrapping="Wrap" Foreground="#1E40AF" LineHeight="20">
                                        <Run Text="1. Enter URL and click"/>
                                        <Run Text="'Start Recording'" FontWeight="SemiBold"/>
                                        <Run Text="- Browser opens"/>
                                        <LineBreak/>
                                        <Run Text="2."/>
                                        <Run Text="Interact with the website" FontWeight="SemiBold"/>
                                        <Run Text="- Every action is"/>
                                        <Run Text="auto-saved instantly!" FontWeight="Bold" Foreground="#10B981"/>
                                        <LineBreak/>
                                        <Run Text="3. Click 'Refresh' in Test Executor to see your test anytime"/>
                                        <LineBreak/>
                                        <Run Text="4."/>
                                        <Run Text="Continue recording" FontWeight="SemiBold"/>
                                        <Run Text="or close browser when done! ✅"/>
                                        <LineBreak/>
                                        <LineBreak/>
                                        <Run Text="💡 Browser stays open - record multiple tests in one session!" FontWeight="SemiBold" Foreground="#7C3AED"/>
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </TabItem>

            <!-- Test Executor Tab -->
            <TabItem Header="▶️ Test Executor">
                <Border Style="{StaticResource Card}" Margin="0,0,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="250"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Test Cases Table Header -->
                        <Grid Grid.Row="0" Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="📋 Test Cases" FontSize="16" FontWeight="SemiBold" Foreground="#374151" VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <Button x:Name="btnStopExecutionMain"
                                        Content="⏹️ Stop Execution"
                                        Style="{StaticResource DangerButton}"
                                        Click="BtnStopExecution_Click"
                                        Height="35"
                                        Width="150"
                                        Visibility="Collapsed"
                                        Margin="0,0,10,0"/>
                                <Button x:Name="btnStopRecordingMain"
                                        Content="🛑 Stop Recording"
                                        Style="{StaticResource DangerButton}"
                                        Click="BtnStopRecording_Click"
                                        Height="35"
                                        Width="150"
                                        Visibility="Collapsed"
                                        Margin="0,0,10,0"/>
                                <Button Content="▶️ Run All Tests"
                                        Style="{StaticResource SuccessButton}"
                                        Click="BtnRunAllTests_Click"
                                        Height="35"
                                        Width="130"
                                        Margin="0,0,10,0"/>
                                <Button Content="🔄 Refresh"
                                        Style="{StaticResource SecondaryButton}"
                                        Click="BtnRefreshTests_Click"
                                        Height="35"
                                        Width="100"/>
                            </StackPanel>
                        </Grid>

                        <!-- Test Cases Table -->
                        <DataGrid x:Name="dgTestCases"
                                  Grid.Row="1"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  CanUserResizeRows="False"
                                  SelectionMode="Single"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="None"
                                  Background="White"
                                  BorderBrush="#D1D5DB"
                                  BorderThickness="1"
                                  RowHeight="40"
                                  FontSize="13"
                                  SelectionChanged="DgTestCases_SelectionChanged"
                                  AllowDrop="True"
                                  PreviewMouseLeftButtonDown="DgTestCases_PreviewMouseLeftButtonDown"
                                  Drop="DgTestCases_Drop">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F9FAFB"/>
                                    <Setter Property="Foreground" Value="#374151"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="10"/>
                                    <Setter Property="BorderBrush" Value="#E5E7EB"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="Padding" Value="10"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#EFF6FF"/>
                                            <Setter Property="Foreground" Value="#1E40AF"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.CellStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Test Name" Binding="{Binding Name}" Width="2*"/>
                                <DataGridTextColumn Header="Platform" Binding="{Binding Platform}" Width="*"/>
                                <DataGridTextColumn Header="Actions" Binding="{Binding ActionCount}" Width="*"/>
                                <DataGridTemplateColumn Header="Operations" Width="200">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="📂 Open"
                                                        Click="BtnOpenTest_Click"
                                                        Tag="{Binding FilePath}"
                                                        Height="28"
                                                        Width="70"
                                                        Margin="0,0,5,0"
                                                        Background="#10B981"
                                                        Foreground="White"
                                                        BorderThickness="0"
                                                        FontSize="11"
                                                        Cursor="Hand">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="Button">
                                                                        <Border Background="{TemplateBinding Background}"
                                                                                CornerRadius="4"
                                                                                Padding="8,4">
                                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#059669"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Button Content="▶️ Run"
                                                        Click="BtnRunTest_Click"
                                                        Tag="{Binding FilePath}"
                                                        Height="28"
                                                        Width="60"
                                                        Margin="0,0,5,0"
                                                        Background="#2563EB"
                                                        Foreground="White"
                                                        BorderThickness="0"
                                                        FontSize="11"
                                                        Cursor="Hand">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="Button">
                                                                        <Border Background="{TemplateBinding Background}"
                                                                                CornerRadius="4"
                                                                                Padding="8,4">
                                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#1D4ED8"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Button Content="🗑️ Del"
                                                        Click="BtnDeleteTest_Click"
                                                        Tag="{Binding FilePath}"
                                                        Height="28"
                                                        Width="60"
                                                        Background="#EF4444"
                                                        Foreground="White"
                                                        BorderThickness="0"
                                                        FontSize="11"
                                                        Cursor="Hand">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="Button">
                                                                        <Border Background="{TemplateBinding Background}"
                                                                                CornerRadius="4"
                                                                                Padding="8,4">
                                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#DC2626"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <!-- Test Steps Header with Loop Control -->
                        <Grid Grid.Row="2" Margin="0,20,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Text="🔍 Test Steps" FontSize="16" FontWeight="SemiBold" Foreground="#374151" VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <TextBlock Text="🔁 Loop Count:" FontSize="13" Foreground="#6B7280" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBox x:Name="txtLoopCount"
                                         Width="60"
                                         Height="32"
                                         Text="1"
                                         FontSize="13"
                                         VerticalContentAlignment="Center"
                                         HorizontalContentAlignment="Center"
                                         Padding="5"
                                         BorderBrush="#D1D5DB"
                                         BorderThickness="1"/>
                            </StackPanel>
                        </Grid>

                        <!-- Test Steps Table -->
                        <DataGrid x:Name="dgTestSteps"
                                  Grid.Row="3"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  CanUserResizeRows="False"
                                  CellEditEnding="DgTestSteps_CellEditEnding"
                                  SelectionMode="Single"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="None"
                                  Background="White"
                                  BorderBrush="#D1D5DB"
                                  BorderThickness="1"
                                  RowHeight="40"
                                  FontSize="13"
                                  MouseRightButtonUp="DgTestSteps_MouseRightButtonUp"
                                  AllowDrop="True"
                                  PreviewMouseLeftButtonDown="DgTestSteps_PreviewMouseLeftButtonDown"
                                  Drop="DgTestSteps_Drop">
                            <DataGrid.ContextMenu>
                                <ContextMenu x:Name="testStepsContextMenu" Opened="TestStepsContextMenu_Opened">
                                    <MenuItem Header="Add Action">
                                        <MenuItem Header="🌐 Open Browser" Click="MenuAddOpenBrowser_Click"/>
                                        <MenuItem Header="🔴 Close Browser" Click="MenuAddCloseBrowser_Click"/>
                                        <Separator/>
                                        <MenuItem Header="⌨️ Press Key" Click="MenuAddPressKey_Click"/>
                                        <MenuItem Header="⏱️ Add Delay" Click="MenuAddDelay_Click"/>
                                        <MenuItem Header="⏳ Add Wait For Element" Click="MenuAddWaitFor_Click"/>
                                    </MenuItem>
                                    <Separator/>
                                    <MenuItem Header="🔗 Navigate to URL" Click="MenuAddNavigateToUrl_Click"/>
                                    <Separator/>
                                    <MenuItem Header="▶️ Start Recording from Here" Click="MenuStartRecordingFromHere_Click"/>
                                    <Separator/>
                                    <MenuItem Header="✓ Continue if Fail" Click="MenuContinueIfFail_Click" IsCheckable="True"/>
                                </ContextMenu>
                            </DataGrid.ContextMenu>
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F9FAFB"/>
                                    <Setter Property="Foreground" Value="#374151"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="10"/>
                                    <Setter Property="BorderBrush" Value="#E5E7EB"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="Padding" Value="10"/>
                                </Style>
                            </DataGrid.CellStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="#" Binding="{Binding StepNumber}" Width="50"/>
                                <DataGridTextColumn Header="Action Type" Binding="{Binding Type}" Width="*"/>
                                <DataGridTextColumn Header="Object" Binding="{Binding ObjectName}" Width="1.5*"/>
                                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="3*"/>
                                <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="2*"/>
                                <DataGridTemplateColumn Header="Operations" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="✏️ Edit"
                                                        Click="BtnEditStep_Click"
                                                        Tag="{Binding Id}"
                                                        Height="28"
                                                        Width="60"
                                                        Margin="0,0,5,0"
                                                        Background="#F59E0B"
                                                        Foreground="White"
                                                        BorderThickness="0"
                                                        FontSize="11"
                                                        Cursor="Hand">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="Button">
                                                                        <Border Background="{TemplateBinding Background}"
                                                                                CornerRadius="4"
                                                                                Padding="8,4">
                                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#D97706"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                                <Button Content="🗑️"
                                                        Click="BtnDeleteStep_Click"
                                                        Tag="{Binding Id}"
                                                        Height="28"
                                                        Width="40"
                                                        Background="#EF4444"
                                                        Foreground="White"
                                                        BorderThickness="0"
                                                        FontSize="11"
                                                        Cursor="Hand">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="Button">
                                                                        <Border Background="{TemplateBinding Background}"
                                                                                CornerRadius="4"
                                                                                Padding="8,4">
                                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                            <Style.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Background" Value="#DC2626"/>
                                                                </Trigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </TabItem>

            <!-- Object Repository Tab -->
            <TabItem Header="📦 Object Repository">
                <Border Background="#1E293B" CornerRadius="8" Margin="20" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Margin="0,0,0,15">
                            <TextBlock Text="Object Repository" FontSize="20" FontWeight="Bold" Foreground="White"/>
                            <TextBlock Text="Captured UI elements and their selectors" FontSize="12" Foreground="#94A3B8" Margin="0,5,0,0"/>
                        </StackPanel>

                        <DataGrid x:Name="dgObjectRepository"
                                  Grid.Row="1"
                                  AutoGenerateColumns="False"
                                  Background="#0F172A"
                                  Foreground="White"
                                  RowBackground="#1E293B"
                                  AlternatingRowBackground="#334155"
                                  BorderThickness="0"
                                  GridLinesVisibility="None"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#334155"/>
                                    <Setter Property="Foreground" Value="#F1F5F9"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="10"/>
                                    <Setter Property="BorderBrush" Value="#475569"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="2*"/>
                                <DataGridTextColumn Header="Tag" Binding="{Binding TagName}" Width="*"/>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="1.5*"/>
                                <DataGridTextColumn Header="Class" Binding="{Binding ClassName}" Width="1.5*"/>
                                <DataGridTextColumn Header="CSS Selector" Binding="{Binding PrimarySelector}" Width="2*"/>
                                <DataGridTextColumn Header="XPath" Binding="{Binding XPath}" Width="2*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </TabItem>

            <!-- Test Report Tab -->
            <TabItem Header="📊 Test Report">
                <Border Background="#1E293B" CornerRadius="8" Margin="20" Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Report Header -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock Text="Test Execution Report" FontSize="24" FontWeight="Bold" Foreground="White"/>
                            <TextBlock x:Name="lblReportDate" Text="No report available" FontSize="12" Foreground="#94A3B8" Margin="0,5,0,0"/>
                        </StackPanel>

                        <!-- Summary Section with Pie Chart -->
                        <Border Grid.Row="1" Background="#0F172A" CornerRadius="8" Padding="20" Margin="0,0,0,20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="200"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Pie Chart Placeholder -->
                                <Canvas x:Name="pieChart" Grid.Column="0" Width="180" Height="180"/>

                                <!-- Summary Stats -->
                                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="30,0,0,0">
                                    <TextBlock Text="Test Summary" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,15"/>

                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Total Steps:" Foreground="#94A3B8" Margin="0,0,20,8"/>
                                        <TextBlock x:Name="lblTotalSteps" Grid.Row="0" Grid.Column="1" Text="0" Foreground="White" FontWeight="Bold" Margin="0,0,0,8"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="✓ Passed:" Foreground="#10B981" Margin="0,0,20,8"/>
                                        <TextBlock x:Name="lblPassedSteps" Grid.Row="1" Grid.Column="1" Text="0" Foreground="#10B981" FontWeight="Bold" Margin="0,0,0,8"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="✗ Failed:" Foreground="#EF4444" Margin="0,0,20,8"/>
                                        <TextBlock x:Name="lblFailedSteps" Grid.Row="2" Grid.Column="1" Text="0" Foreground="#EF4444" FontWeight="Bold" Margin="0,0,0,8"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Success Rate:" Foreground="#94A3B8" Margin="0,0,20,8"/>
                                        <TextBlock x:Name="lblSuccessRate" Grid.Row="3" Grid.Column="1" Text="0%" Foreground="White" FontWeight="Bold" Margin="0,0,0,8"/>

                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="⏱️ Total Time:" Foreground="#94A3B8" Margin="0,0,20,8"/>
                                        <TextBlock x:Name="lblTotalTime" Grid.Row="4" Grid.Column="1" Text="0ms" Foreground="White" FontWeight="Bold" Margin="0,0,0,8"/>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Detailed Step Results -->
                        <DataGrid x:Name="dgReportSteps"
                                  Grid.Row="2"
                                  AutoGenerateColumns="False"
                                  Background="#0F172A"
                                  Foreground="White"
                                  RowBackground="#1E293B"
                                  AlternatingRowBackground="#334155"
                                  BorderThickness="0"
                                  GridLinesVisibility="None"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#334155"/>
                                    <Setter Property="Foreground" Value="#F1F5F9"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="10"/>
                                    <Setter Property="BorderBrush" Value="#475569"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="#" Binding="{Binding StepNumber}" Width="50"/>
                                <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                                <DataGridTextColumn Header="Action" Binding="{Binding Action}" Width="*"/>
                                <DataGridTextColumn Header="Object" Binding="{Binding Object}" Width="1.5*"/>
                                <DataGridTextColumn Header="Time (ms)" Binding="{Binding ExecutionTime}" Width="100"/>
                                <DataGridTextColumn Header="Error" Binding="{Binding ErrorMessage}" Width="2*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </TabItem>
        </TabControl>

        <!-- Output Console -->
        <Border Grid.Row="2"
                Background="#1E293B"
                CornerRadius="8"
                Margin="20,10,20,20"
                Padding="15">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="10" ShadowDepth="0"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Text="📟 Console Output"
                           FontSize="12"
                           FontWeight="SemiBold"
                           Foreground="#94A3B8"
                           Margin="0,0,0,10"/>

                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <TextBox x:Name="txtOutput"
                             Background="Transparent"
                             Foreground="#10B981"
                             BorderThickness="0"
                             FontFamily="Consolas"
                             FontSize="12"
                             IsReadOnly="True"
                             TextWrapping="Wrap"
                             VerticalAlignment="Stretch"/>
                </ScrollViewer>
            </Grid>
        </Border>
    </Grid>
</Window>
